{"version":3,"sources":["serviceWorker.ts","components/three.tsx","assets/star.png","threejs/index.ts","threejs/config.ts","hooks/useWindowSize.tsx","routes.tsx","index.tsx"],"names":["Boolean","window","location","hostname","match","frameId","WHITE","LIGHT_CREAM","LIGHT_YELLOW","PANTONE_BLUE_2020","NIGHT_OWL_BLUE","scene","bgColor","Scene","background","Color","setupScene","lights","directionalLight","DirectionalLight","directionalLight2","position","set","AmbientLight","HemisphereLight","setupLights","add","circle","circleGeo","CircleGeometry","circleMat","MeshBasicMaterial","color","Mesh","setupCircle","areaImage","Image","src","SMAAEffect","areaImageDataURL","searchImage","searchImageDataURL","smaaEffect","stars","starCount","starTexture","TextureLoader","load","star","starGeo","Geometry","i","Vector3","Math","random","extendedStar","velocity","vertices","push","starMaterial","PointsMaterial","size","transparent","map","Points","setupStars","textGeometry","audioLoader","listener","sound","analyser","font","FontLoader","parse","fontJson","geometry","TextBufferGeometry","height","curveSegments","computeBoundingBox","loadText","textMesh","MeshPhysicalMaterial","metalness","roughness","opacity","envMapIntensity","textLine","LineSegments","EdgesGeometry","LineBasicMaterial","linewidth","createFontLine","textObj","Object3D","camera","windowWidth","windowHeight","PerspectiveCamera","x","y","z","setupCamera","innerWidth","innerHeight","init","a","AudioLoader","AudioListener","context","resume","Audio","AudioAnalyser","godRaysEffect","GodRaysEffect","resolutionScale","density","decay","weight","samples","renderPass","RenderPass","effectPass","EffectPass","renderToScreen","composer","EffectComposer","renderer","WebGLRenderer","antialias","setSize","setupRenderer","addPass","orbitControls","OrbitControls","domElement","enablePan","maxDistance","minDistance","rotateSpeed","zoomSpeed","ThreeScene","useState","isClicked","setIsClicked","isMesh","setFontForm","isAudioLoaded","setAudioLoadingStatus","isMuted","setMuteStatus","isOrientControl","setChecked","debounceSetFontForm","useCallback","debounce","visible","controls","divRef","useRef","isClient","getSize","width","windowSize","setWindowSize","useEffect","handleResize","addEventListener","removeEventListener","useWindowSize","isMobile","DeviceOrientationControls","deviceOrientation","fog","FogExp2","animate","update","requestAnimationFrame","audioData","getFrequencyData","snareDrum","val","forEach","eStar","verticesNeedUpdate","rotation","starsMove","render","start","stop","cancelAnimationFrame","process","buffer","setBuffer","setLoop","setVolume","play","xhr","loadingStatus","loaded","total","console","info","floor","log","aspect","updateProjectionMatrix","onWindowResize","divEl","current","appendChild","removeChild","connect","enabled","disconnect","dispose","className","icon","faVolumeMute","faVolumeUp","onClick","type","checked","onChange","ref","href","Date","getFullYear","rel","target","routes","path","exact","component","memo","ReactDOM","basename","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"2qEAYoBA,QACW,cAA7BC,OAAOC,SAASC,UAEe,UAA7BF,OAAOC,SAASC,UAEhBF,OAAOC,SAASC,SAASC,MAAM,2D,ICwB/BC,E,yICzCW,2qFC6BPC,EC5BC,SD4BMC,EC3BA,SD2BaC,EC1BZ,SD0B0BC,ECzBrB,QHmCbC,EGlCU,KHuCZC,EEboB,SAACC,GACzB,IAAMD,EAAQ,IAAIE,KAElB,OADAF,EAAMG,WAAa,IAAIC,IAAMH,GACtBD,EFUKK,CAAWN,GAEnBO,EEDqB,WACzB,IAAMC,EAAmB,IAAIC,IAAiBX,EAAc,GACtDY,EAAoB,IAAID,IAAiBX,EAAc,IAK7D,OAJAU,EAAiBG,SAASC,IAAI,EAAG,KAAM,MACvCF,EAAkBC,SAASC,IAAI,EAAG,IAAK,KAGhC,CAACJ,EAAkBE,EAFL,IAAIG,IAAahB,EAAa,IAC3B,IAAIiB,IAAgBjB,EAAaE,EAAmB,KFL/DgB,GACfd,EAAMe,IAAN,MAAAf,EAAK,YAAQM,IAEb,IAAMU,EE8CqB,WACzB,IAAMC,EAAY,IAAIC,IAAe,IAAK,IACpCC,EAAY,IAAIC,IAAkB,CAAEC,MAAOxB,IAC3CmB,EAAS,IAAIM,IAAKL,EAAWE,GAEnC,OADAH,EAAON,SAASC,IAAI,EAAG,KAAM,MACtBK,EFnDMO,GACfvB,EAAMe,IAAIC,GAEV,IAAMQ,EAAY,IAAIC,MACtBD,EAAUE,IAAMC,IAAWC,iBAC3B,IAAMC,EAAc,IAAIJ,MACxBI,EAAYH,IAAMC,IAAWG,mBAC7B,IAAMC,EAAa,IAAIJ,IAAWE,EAAaL,EAAW,GAEpDQ,EEiDoB,WAGxB,IAH+C,IAAtBC,EAAqB,uDAAT,IAC/BC,GAAc,IAAIC,MAAgBC,KAAKC,GACvCC,EAAU,IAAIC,IACXC,EAAI,EAAGA,EAAIP,EAAWO,IAAK,CAClC,IAAMH,EAAO,IAAII,KACC,IAAhBC,KAAKC,SAAkB,KACP,IAAhBD,KAAKC,SAAkB,KACP,IAAhBD,KAAKC,SAAkB,MAEnBC,EAAY,2BAAQP,GAAR,IAAcQ,SAAU,IAC1CP,EAAQQ,SAASC,KAAKH,GAExB,IAAMI,EAAe,IAAIC,KAAe,CACtC5B,MAAOzB,EACPsD,KAAM,EACNC,aAAa,EACbC,IAAKlB,IAEP,OAAO,IAAImB,KAAOf,EAASU,GFnEfM,GACdtD,EAAMe,IAAIiB,GAEV,IEA+BuB,EFS3BC,EACAC,EACAC,EACAC,EAZEJ,EEqBkB,WACtB,IACMK,GADa,IAAIC,KACCC,MAAMC,GACxBC,EAAW,IAAIC,KAAmB,SAAK,CAC3CL,OACAV,KAAM,IACNgB,OAAQ,GACRC,cAAe,IAGjB,OADAH,EAASI,qBACFJ,EF/BYK,GACfC,GEDyBf,EFCCA,EEA9B,IAAIjC,IACFiC,EACA,IAAIgB,KAAqB,CACvBlD,MAAOvB,EACP0E,UAAW,GACXC,UAAW,GACXC,QAAS,GACTC,gBAAiB,MFLjBC,EESwB,SAACrB,GAAD,OAC5B,IAAIsB,IACF,IAAIC,IAAcvB,GAClB,IAAIwB,IAAkB,CACpB1D,MAAO1B,EACPqF,UAAW,KFdAC,CAAe1B,GAE1B2B,GAAU,IAAIC,MAAWpE,IAAIuD,EAAUM,GAC7CM,EAAQxE,SAASC,KAAK,KAAM,GAAI,GAChCX,EAAMe,IAAImE,GAOV,IAAME,EEtCqB,SAACC,EAAqBC,GAC/C,IAAMF,EAAS,IAAIG,KAAkB,GAAIF,EAAcC,EAAc,EAAG,KAIxE,OAHAF,EAAO1E,SAAS8E,GAAK,IACrBJ,EAAO1E,SAAS+E,EAAI,IACpBL,EAAO1E,SAASgF,EAAI,IACbN,EFiCMO,CAAYrG,OAAOsG,WAAYtG,OAAOuG,aAE/CC,EAAI,uCAAG,sBAAAC,EAAA,6DACXvC,EAAc,IAAIwC,IAClBvC,EAAW,IAAIwC,IAFJ,SAGLxC,EAASyC,QAAQC,SAHZ,OAIXzC,EAAQ,IAAI0C,IAAM3C,GAClBE,EAAW,IAAI0C,IAAc3C,EG1ER,MH2ErB0B,EAAOrE,IAAI0C,GANA,2CAAH,qDASJ6C,EAAgB,IAAIC,IAAcnB,EAAQpE,EAAQ,CACtDwF,gBAAiB,EACjBC,QAAS,GACTC,MAAO,IACPC,OAAQ,GACRC,QAAS,MAGLC,EAAa,IAAIC,IAAW9G,EAAOoF,GACnC2B,EAAa,IAAIC,IAAW5B,EAAQrD,EAAYuE,GACtDS,EAAWE,gBAAiB,EAC5B,IAAMC,EAAW,IAAIC,IE1CQ,SAAC9B,EAAqBC,GACjD,IAAM8B,EAAW,IAAIC,KAAc,CAAEC,WAAW,IAEhD,OADAF,EAASG,QAAQlC,EAAaC,GACvB8B,EFuC2BI,CAAclI,OAAOsG,WAAYtG,OAAOuG,cAC5EqB,EAASO,QAAQZ,GACjBK,EAASO,QAAQV,GAEjB,IAAMK,GAAWF,EAASE,SAEpBM,GAAgB,IAAIC,IAAcvC,EAAQgC,GAASQ,YACzDF,GAAcG,WAAY,EAC1BH,GAAcI,YAAc,KAC5BJ,GAAcK,YAAc,IAC5BL,GAAcM,YAAc,GAC5BN,GAAcO,UAAY,GAE1B,IAoBMC,GAAa,WAAO,IAAD,EACWC,oBAAS,GADpB,mBAChBC,EADgB,KACLC,EADK,OAEOF,oBAAS,GAFhB,mBAEhBG,EAFgB,KAERC,EAFQ,OAGwBJ,oBAAS,GAHjC,mBAGhBK,EAHgB,KAGDC,EAHC,OAIUN,oBAAS,GAJnB,mBAIhBO,EAJgB,KAIPC,EAJO,OAKeR,oBAAS,GALxB,mBAKhBS,EALgB,KAKCC,EALD,KAOjBC,EAAsBC,sBAAYC,IAAST,EAAa,IAAK,IAEnEjE,EAAS2E,QAAUX,EACnB1D,EAASqE,SAAWX,EAEpB,IAGIY,EAHEC,EAASC,iBAAuB,MAZf,EI/HV,WACb,IAAMC,EAA6B,kBAAX/J,OAElBgK,EAAU,WACd,MAAO,CACLC,MAAOF,EAAW/J,OAAOsG,WAAa,IACtC1B,OAAQmF,EAAW/J,OAAOuG,YAAc,MANzB,EAUiBsC,mBAASmB,GAV1B,mBAUZE,EAVY,KAUAC,EAVA,KAyBnB,OAbAC,qBAAU,WACR,GAAKL,EAAL,CAIA,IAAMM,EAAe,WACnBF,EAAcH,MAIhB,OADAhK,OAAOsK,iBAAiB,SAAUD,GAC3B,kBAAMrK,OAAOuK,oBAAoB,SAAUF,QAG7CH,EJmHmBM,GAAlBP,EAbe,EAafA,MAAOrF,EAbQ,EAaRA,OAIX6F,aACFb,EAAW,IAAIc,IAA0B5E,IAChC6E,kBAAoB,EAC7BjK,EAAMkK,IAAM,MAEM,OAAdlK,EAAMkK,MACRlK,EAAMkK,IAAM,IAAIC,IAAQpK,EAAgB,OAI5C,IAOMqK,EAAU,SAAVA,IACJL,YAAYb,GAAYA,EAASmB,SACjC3K,EAAUJ,OAAOgL,sBAAsBF,GAEvC,IAAMG,EAAY5G,GAAYA,EAAS6G,mBAEvC,GAAID,EAAW,CACIA,EAAU,GAA3B,IACME,EAAYF,EAAU,IAQxBE,GAAa,IACf3B,GAAoB,GACX2B,EAAY,GAAKA,GAAa,KACvC3B,GAAoB,IArEV,WAAiB,IAAhB4B,EAAe,uDAAT,IACjBpI,EAAUN,EAAMgC,SACtB1B,EAAQQ,SAAS6H,SAAQ,SAACtI,GACxB,IAAMuI,EAAQvI,EACduI,EAAM/H,UAAY6H,EAAsB,IAAhBhI,KAAKC,SAC7BiI,EAAMlF,GAAKkF,EAAM/H,SACb+H,EAAMlF,EAAI,OACZkF,EAAMlF,GAAK,KACXkF,EAAM/H,SAAW,MAGrBP,EAAQuI,oBAAqB,EAC7B7I,EAAM8I,SAASpF,GAAK,KA6DlBqF,GA5EF7D,EAAS8D,OAAOhL,EAAOoF,IAgFjB6F,EAAQ,WACPvL,IACHA,EAAU4K,sBAAsBF,KAI9Bc,EAAO,WACXxL,GAAWyL,qBAAqBzL,GAChCA,EAAU,MA+DZ,OA5DAgK,qBAAU,WACRtB,IACGI,GACDhF,GACAA,EAAYpB,KAAZ,UACKgJ,SADL,iBAEE,SAAAC,GACM3H,IACFA,EAAM4H,UAAUD,GAChB3H,EAAM6H,SAAQ,GACd9C,GAAsB,GACtB/E,EAAM8H,UAAU9C,EAAU,EAAI,GAC9BhF,EAAM+H,WAGV,SAAAC,GACE,IAAMC,EAAiBD,EAAIE,OAASF,EAAIG,MAAS,IACjDC,QAAQC,KAAR,yBAA+BrJ,KAAKsJ,MAAML,GAA1C,MACsB,MAAlBA,GACFG,QAAQG,IAAI,yBAKnB,CAAC7D,IAEJsB,qBAAU,YAvEa,SAACH,EAAerF,GACrCkB,EAAO8G,OAAS3C,EAAQrF,EACxBkB,EAAO+G,yBAEPjF,EAASK,QAAQgC,EAAOrF,GAoExBkI,CAAe7C,EAAOrF,GAEjB6F,YACHkB,IAGF,IAAMoB,EAAQlD,EAAOmD,QAGrB,OAFK,OAALD,QAAK,IAALA,KAAOE,YAAYnF,GAASQ,YAErB,WACLsD,IACK,OAALmB,QAAK,IAALA,KAAOG,YAAYpF,GAASQ,eAG7B,CAAC2B,EAAOrF,IAEXwF,qBACE,WACiB,IAAD,EAAVK,aACM,QAAR,EAAAb,SAAA,SAAUuD,UACNvD,IAAUA,EAASwD,QAAU9D,GACjCqC,KAEF,OAAO,WAAO,IAAD,IACH,QAAR,EAAA/B,SAAA,SAAUyD,aACF,QAAR,EAAAzD,SAAA,SAAU0D,UACV1B,OAIJ,CAACnB,WAAUnB,IAIX,qCACIJ,EAoDE,KAnDF,qBAAKqE,UAAU,UAAf,SACE,sBAAKA,UAAU,qBAAf,UACE,mBAAGA,UAAU,QAAb,uFAGA,uBAAOA,UAAU,SAAjB,qCACA,cAAC,IAAD,CACEC,KAAMpE,EAAUqE,IAAeC,IAC/BH,UAAU,iBACV3J,KAAK,KACL+J,QAAS,kBAAMtE,GAAeD,OAE9BN,GACA,wBACEyE,UAAU,eACVI,QAAS,WACPnH,IACAuC,GAAa,IAJjB,mBAUDD,GACC,sBAAKyE,UAAU,eAAf,UACE,wBACA,wBACA,2BAGH9C,YACC,sBAAK8C,UAAU,sBAAf,UACE,uBAAOA,UAAU,QAAjB,gCACA,uBACEA,UAAU,WACVK,KAAK,WACLC,QAASvE,EACTwE,SAAU,kBAAMvE,GAAYD,SAIlC,wBAAOiE,UAAU,OAAjB,UACG9C,WACGnB,EACE,4CACA,2BACF,wBALN,qBAWN,qBAAKyE,IAAKlE,EAAQ0D,UAAU,oBAE5B,mCACE,wBAAOA,UAAU,eAAjB,sCAC4B,IAC1B,mBAAGS,KAAK,gDAAR,yBAEF,wBAAOT,UAAU,KAAjB,mBACU,IAAIU,MAAOC,cAAe,IAClC,mBAAGF,KAAK,0BAA0BG,IAAI,sBAAsBC,OAAO,SAAnE,oCK1TKC,GAFS,CAAC,CAAEC,KAAM,IAAKC,OAAO,EAAMC,ULqUpCC,eAAK7F,MMtUpB8F,IAAShD,OACP,cAAC,IAAD,CAAeiD,SAAU7C,SAAzB,SACE,cAAC,IAAD,UACGuC,GAAOvK,KAAI,gBAAGwK,EAAH,EAAGA,KAAMC,EAAT,EAASA,MAAOC,EAAhB,EAAgBA,UAAhB,OACV,cAAC,IAAD,CAAkBF,KAAMA,EAAMC,MAAOA,EAAOC,UAAWA,GAA3CF,UAIlBM,SAASC,eAAe,SPqHpB,kBAAmBC,WACrBA,UAAUC,cAAcC,MAAMC,MAAK,SAAAC,GACjCA,EAAaC,kB","file":"static/js/main.d76a9881.chunk.js","sourcesContent":["// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === \"localhost\" ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === \"[::1]\" ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(/^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === \"production\" && \"serviceWorker\" in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener(\"load\", () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        // eslint-disable-next-line @typescript-eslint/no-use-before-define\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            \"This web app is being served cache-first by a service \" +\n              \"worker. To learn more, visit https://bit.ly/CRA-PWA\"\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        // eslint-disable-next-line @typescript-eslint/no-use-before-define\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === \"installed\") {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                \"New content is available and will be used when all \" +\n                  \"tabs for this page are closed. See https://bit.ly/CRA-PWA.\"\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log(\"Content is cached for offline use.\");\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error(\"Error during service worker registration:\", error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { \"Service-Worker\": \"script\" }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get(\"content-type\");\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf(\"javascript\") === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\"No internet connection found. App is running in offline mode.\");\n    });\n}\n\nexport function unregister() {\n  if (\"serviceWorker\" in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React, { useRef, useEffect, useState, useCallback, memo } from \"react\";\r\nimport {\r\n  Object3D,\r\n  Geometry,\r\n  WebGLRenderer,\r\n  AudioListener,\r\n  AudioLoader,\r\n  AudioAnalyser,\r\n  Audio,\r\n  FogExp2\r\n} from \"three\";\r\nimport { GodRaysEffect, RenderPass, EffectPass, EffectComposer, SMAAEffect } from \"postprocessing\";\r\nimport { isMobile } from \"react-device-detect\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport { faVolumeUp, faVolumeMute } from \"@fortawesome/free-solid-svg-icons\";\r\nimport debounce from \"lodash.debounce\";\r\n\r\nimport { OrbitControls } from \"three/examples/jsm/controls/OrbitControls.js\";\r\nimport { DeviceOrientationControls } from \"three/examples/jsm/controls/DeviceOrientationControls.js\";\r\n\r\nimport useWindowSize from \"../hooks/useWindowSize\";\r\n\r\nimport \"../style/three.css\";\r\n\r\nimport {\r\n  setupRenderer,\r\n  setupCamera,\r\n  setupScene,\r\n  setupLights,\r\n  setupCircle,\r\n  loadText,\r\n  createFontMesh,\r\n  createFontLine,\r\n  setupStars,\r\n  ExtendedVector3\r\n} from \"../threejs\";\r\n\r\nimport { colorPalette, fftSize } from \"../threejs/config\";\r\n\r\nconst { NIGHT_OWL_BLUE } = colorPalette;\r\n\r\nlet frameId: number | null;\r\n\r\n// Three Scene init setup start\r\nconst scene = setupScene(NIGHT_OWL_BLUE);\r\n\r\nconst lights = setupLights();\r\nscene.add(...lights);\r\n\r\nconst circle = setupCircle();\r\nscene.add(circle);\r\n\r\nconst areaImage = new Image();\r\nareaImage.src = SMAAEffect.areaImageDataURL;\r\nconst searchImage = new Image();\r\nsearchImage.src = SMAAEffect.searchImageDataURL;\r\nconst smaaEffect = new SMAAEffect(searchImage, areaImage, 1);\r\n\r\nconst stars = setupStars();\r\nscene.add(stars);\r\n\r\nconst textGeometry = loadText();\r\nconst textMesh = createFontMesh(textGeometry);\r\n\r\nconst textLine = createFontLine(textGeometry);\r\n\r\nconst textObj = new Object3D().add(textMesh, textLine);\r\ntextObj.position.set(-150, -90, 0);\r\nscene.add(textObj);\r\n\r\nlet audioLoader: AudioLoader;\r\nlet listener: AudioListener;\r\nlet sound: Audio;\r\nlet analyser: AudioAnalyser;\r\n\r\nconst camera = setupCamera(window.innerWidth, window.innerHeight);\r\n\r\nconst init = async () => {\r\n  audioLoader = new AudioLoader();\r\n  listener = new AudioListener();\r\n  await listener.context.resume();\r\n  sound = new Audio(listener);\r\n  analyser = new AudioAnalyser(sound, fftSize);\r\n  camera.add(listener);\r\n};\r\n\r\nconst godRaysEffect = new GodRaysEffect(camera, circle, {\r\n  resolutionScale: 1,\r\n  density: 0.9,\r\n  decay: 0.95,\r\n  weight: 0.4,\r\n  samples: 100\r\n});\r\n\r\nconst renderPass = new RenderPass(scene, camera);\r\nconst effectPass = new EffectPass(camera, smaaEffect, godRaysEffect);\r\neffectPass.renderToScreen = true;\r\nconst composer = new EffectComposer(setupRenderer(window.innerWidth, window.innerHeight));\r\ncomposer.addPass(renderPass);\r\ncomposer.addPass(effectPass);\r\n\r\nconst renderer = composer.renderer as WebGLRenderer;\r\n\r\nconst orbitControls = new OrbitControls(camera, renderer.domElement);\r\norbitControls.enablePan = false;\r\norbitControls.maxDistance = 1500;\r\norbitControls.minDistance = 200;\r\norbitControls.rotateSpeed = 0.4;\r\norbitControls.zoomSpeed = 0.6;\r\n\r\nconst renderScene = () => {\r\n  composer.render(scene, camera);\r\n};\r\n\r\nconst starsMove = (val = 0.05) => {\r\n  const starGeo = stars.geometry as Geometry;\r\n  starGeo.vertices.forEach((star: unknown) => {\r\n    const eStar = star as ExtendedVector3;\r\n    eStar.velocity += val + Math.random() * 0.01;\r\n    eStar.z += eStar.velocity;\r\n    if (eStar.z > 1500) {\r\n      eStar.z = -1500;\r\n      eStar.velocity = 0;\r\n    }\r\n  });\r\n  starGeo.verticesNeedUpdate = true;\r\n  stars.rotation.z -= 0.0005;\r\n};\r\n// Three Scene init setup end\r\n\r\nconst ThreeScene = () => {\r\n  const [isClicked, setIsClicked] = useState(false);\r\n  const [isMesh, setFontForm] = useState(true);\r\n  const [isAudioLoaded, setAudioLoadingStatus] = useState(false);\r\n  const [isMuted, setMuteStatus] = useState(false);\r\n  const [isOrientControl, setChecked] = useState(false);\r\n\r\n  const debounceSetFontForm = useCallback(debounce(setFontForm, 10), []);\r\n\r\n  textMesh.visible = isMesh;\r\n  textLine.visible = !isMesh;\r\n\r\n  const divRef = useRef<HTMLDivElement>(null);\r\n  const { width, height } = useWindowSize();\r\n\r\n  let controls: null | DeviceOrientationControls;\r\n\r\n  if (isMobile) {\r\n    controls = new DeviceOrientationControls(camera);\r\n    controls.deviceOrientation = 0;\r\n    scene.fog = null;\r\n  } else {\r\n    if (scene.fog === null) {\r\n      scene.fog = new FogExp2(NIGHT_OWL_BLUE, 0.0005);\r\n    }\r\n  }\r\n\r\n  const onWindowResize = (width: number, height: number) => {\r\n    camera.aspect = width / height;\r\n    camera.updateProjectionMatrix();\r\n\r\n    composer.setSize(width, height);\r\n  };\r\n\r\n  const animate = () => {\r\n    isMobile && controls && controls.update();\r\n    frameId = window.requestAnimationFrame(animate);\r\n\r\n    const audioData = analyser && analyser.getFrequencyData();\r\n\r\n    if (audioData) {\r\n      const bassDrum = audioData[0];\r\n      const snareDrum = audioData[41];\r\n\r\n      if (bassDrum >= 235) {\r\n        // do something when bass drum hit\r\n      } else if (bassDrum > 0 && bassDrum <= 195) {\r\n        // go back to previous status after bass drum hit\r\n      }\r\n\r\n      if (snareDrum >= 155) {\r\n        debounceSetFontForm(false);\r\n      } else if (snareDrum > 0 && snareDrum <= 100) {\r\n        debounceSetFontForm(true);\r\n      }\r\n    }\r\n\r\n    starsMove();\r\n    renderScene();\r\n  };\r\n\r\n  const start = () => {\r\n    if (!frameId) {\r\n      frameId = requestAnimationFrame(animate);\r\n    }\r\n  };\r\n\r\n  const stop = () => {\r\n    frameId && cancelAnimationFrame(frameId);\r\n    frameId = null;\r\n  };\r\n\r\n  useEffect(() => {\r\n    isClicked &&\r\n      !isAudioLoaded &&\r\n      audioLoader &&\r\n      audioLoader.load(\r\n        `${process.env.PUBLIC_URL}/BlueBoi.mp3`,\r\n        buffer => {\r\n          if (sound) {\r\n            sound.setBuffer(buffer);\r\n            sound.setLoop(true);\r\n            setAudioLoadingStatus(true);\r\n            sound.setVolume(isMuted ? 0 : 1);\r\n            sound.play();\r\n          }\r\n        },\r\n        xhr => {\r\n          const loadingStatus = (xhr.loaded / xhr.total) * 100;\r\n          console.info(`Audio Loading: ${Math.floor(loadingStatus)}%`);\r\n          if (loadingStatus === 100) {\r\n            console.log(\"Loading Complete\");\r\n          }\r\n        }\r\n      );\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [isClicked]);\r\n\r\n  useEffect(() => {\r\n    onWindowResize(width, height);\r\n\r\n    if (!isMobile) {\r\n      start();\r\n    }\r\n\r\n    const divEl = divRef.current;\r\n    divEl?.appendChild(renderer.domElement);\r\n\r\n    return () => {\r\n      stop();\r\n      divEl?.removeChild(renderer.domElement);\r\n    };\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [width, height]);\r\n\r\n  useEffect(\r\n    () => {\r\n      if (isMobile) {\r\n        controls?.connect();\r\n        if (controls) controls.enabled = isOrientControl;\r\n        start();\r\n      }\r\n      return () => {\r\n        controls?.disconnect();\r\n        controls?.dispose();\r\n        stop();\r\n      };\r\n    },\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    [isMobile, isOrientControl]\r\n  );\r\n\r\n  return (\r\n    <>\r\n      {!isAudioLoaded ? (\r\n        <div className=\"overlay\">\r\n          <div className=\"overlay--container\">\r\n            <q className=\"quote\">\r\n              If you gaze long enough into an abyss, the abyss will gaze back into you.\r\n            </q>\r\n            <small className=\"author\"> -- Friedrich Nietzsche</small>\r\n            <FontAwesomeIcon\r\n              icon={isMuted ? faVolumeMute : faVolumeUp}\r\n              className=\"volume-control\"\r\n              size=\"2x\"\r\n              onClick={() => setMuteStatus(!isMuted)}\r\n            />\r\n            {!isClicked && (\r\n              <button\r\n                className=\"start-button\"\r\n                onClick={() => {\r\n                  init();\r\n                  setIsClicked(true);\r\n                }}\r\n              >\r\n                Start\r\n              </button>\r\n            )}\r\n            {isClicked && (\r\n              <div className=\"lds-facebook\">\r\n                <div></div>\r\n                <div></div>\r\n                <div></div>\r\n              </div>\r\n            )}\r\n            {isMobile && (\r\n              <div className=\"orientation-control\">\r\n                <small className=\"label\">Device Orientation</small>\r\n                <input\r\n                  className=\"checkbox\"\r\n                  type=\"checkbox\"\r\n                  checked={isOrientControl}\r\n                  onChange={() => setChecked(!isOrientControl)}\r\n                />\r\n              </div>\r\n            )}\r\n            <small className=\"hint\">\r\n              {isMobile\r\n                ? isOrientControl\r\n                  ? \"Move your device around (or Touch/Pinch) \"\r\n                  : \"Touch/Pinch your screen \"\r\n                : \"Darg/Zoom your mouse \"}\r\n              to explore\r\n            </small>\r\n          </div>\r\n        </div>\r\n      ) : null}\r\n      <div ref={divRef} className=\"three-container\"></div>\r\n\r\n      <footer>\r\n        <small className=\"music-credit\">\r\n          Music by LAKEY INSPIRED -{\" \"}\r\n          <a href=\"https://soundcloud.com/lakeyinspired/blue-boi\">Blue Boi</a>\r\n        </small>\r\n        <small className=\"me\">\r\n          &copy; {new Date().getFullYear()}{\" \"}\r\n          <a href=\"https://haoranzhang.me/\" rel=\"noopener noreferrer\" target=\"_blank\">\r\n            Haoran Zhang\r\n          </a>\r\n        </small>\r\n      </footer>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default memo(ThreeScene);\r\n","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAACXBIWXMAAAsTAAALEwEAmpwYAAAF0WlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDUgNzkuMTYzNDk5LCAyMDE4LzA4LzEzLTE2OjQwOjIyICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdEV2dD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlRXZlbnQjIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHhtbG5zOnBob3Rvc2hvcD0iaHR0cDovL25zLmFkb2JlLmNvbS9waG90b3Nob3AvMS4wLyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDE5LTA5LTEwVDA4OjI3OjI4KzA3OjAwIiB4bXA6TWV0YWRhdGFEYXRlPSIyMDE5LTA5LTEwVDA4OjI3OjI4KzA3OjAwIiB4bXA6TW9kaWZ5RGF0ZT0iMjAxOS0wOS0xMFQwODoyNzoyOCswNzowMCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo0ZmU0ODhkMy0wMjU5LWQ0NDEtOWNlMS1mNDg2NzEwNWU3NjQiIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDo3NDNmOTk3Ny0yMjVlLWIyNDktYjMzNy0wNTA2MGU1NTM0NjEiIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo0ZThiNTZjMS04NjVmLTNkNGItYTk1Yy03YjY2Mzk1ZDIwMDMiIGRjOmZvcm1hdD0iaW1hZ2UvcG5nIiBwaG90b3Nob3A6Q29sb3JNb2RlPSIzIj4gPHhtcE1NOkhpc3Rvcnk+IDxyZGY6U2VxPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iY3JlYXRlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDo0ZThiNTZjMS04NjVmLTNkNGItYTk1Yy03YjY2Mzk1ZDIwMDMiIHN0RXZ0OndoZW49IjIwMTktMDktMTBUMDg6Mjc6MjgrMDc6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE5IChXaW5kb3dzKSIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6NGZlNDg4ZDMtMDI1OS1kNDQxLTljZTEtZjQ4NjcxMDVlNzY0IiBzdEV2dDp3aGVuPSIyMDE5LTA5LTEwVDA4OjI3OjI4KzA3OjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPC9yZGY6U2VxPiA8L3htcE1NOkhpc3Rvcnk+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+0FZuFwAAAcBJREFUaN7lmklOAkEUhlmIF5BARLea4GEQV5Do2oQdmOBCz6C9EK8i3IEOstRwBSEBlKghfC58nXS0VYYe6pV/8jadrqr+UkPXG1JAygYLs7MsUAYcoAU8AAPgVWwgz1ryTlnaGAGyBdSBDjBnec2lbV36ih1kG7gCnglPL8ANkI8DZANoABOi00TGSEcFsgd0iU/3wEHYIIfAiPg1AUphgZwCM5LTTL5hLZAq5qi6Kkgx4ZkImpnisiCFiE+mdfZMYVGQNNDDXPWCjuYgkAbm6/wvkLyhSypoieV/A2miR7c/gWSAqSKQqXzzN5Aa+lQLAnEVgnS+gmRX9CeS1tzb9B5IBb069oM4ikEcP0hLMcidH6SvGKTvBxkrBhn7QbTLCpA3W5bWk5Wb3Zrj15ofouYryokfJGfLpVHrNd61xbE6s9rVTYlDrz74YFU4yJoAnRcy7RoM0WXBkKmXnRoZCDEG9vmPaQWrEj1Wpd48K5FcMvQI5enpHhGkpz3bBC4ivspMgUsZK/ISjh3gmvBLOJrALgkU1WT4LIhxWb2oxpU+MhhS5pQTT9MB2sAjMATexYbyrC3vVKSNcfVaidoHrhc50nP+8ssAAAAASUVORK5CYII=\"","import {\r\n  Scene,\r\n  Color,\r\n  PerspectiveCamera,\r\n  DirectionalLight,\r\n  WebGLRenderer,\r\n  TextBufferGeometry,\r\n  Mesh,\r\n  LineSegments,\r\n  EdgesGeometry,\r\n  LineBasicMaterial,\r\n  FontLoader,\r\n  CircleGeometry,\r\n  MeshBasicMaterial,\r\n  MeshPhysicalMaterial,\r\n  AmbientLight,\r\n  HemisphereLight,\r\n  Geometry,\r\n  Vector3,\r\n  PointsMaterial,\r\n  Points,\r\n  TextureLoader\r\n} from \"three\";\r\n\r\nimport fontJson from \"../assets/hao.json\";\r\nimport star from \"../assets/star.png\";\r\n\r\nimport { colorPalette } from \"./config\";\r\n\r\nconst { WHITE, LIGHT_CREAM, LIGHT_YELLOW, PANTONE_BLUE_2020 } = colorPalette;\r\n\r\nexport const setupScene = (bgColor: string | number | Color | undefined) => {\r\n  const scene = new Scene();\r\n  scene.background = new Color(bgColor);\r\n  return scene;\r\n};\r\n\r\nexport const setupCamera = (windowWidth: number, windowHeight: number) => {\r\n  const camera = new PerspectiveCamera(60, windowWidth / windowHeight, 1, 50000);\r\n  camera.position.x = -500;\r\n  camera.position.y = 300;\r\n  camera.position.z = 800;\r\n  return camera;\r\n};\r\n\r\nexport const setupLights = () => {\r\n  const directionalLight = new DirectionalLight(LIGHT_YELLOW, 3);\r\n  const directionalLight2 = new DirectionalLight(LIGHT_YELLOW, 0.6);\r\n  directionalLight.position.set(0, 200, -2500);\r\n  directionalLight2.position.set(0, 200, 3000);\r\n  const ambientLight = new AmbientLight(LIGHT_CREAM, 0.4);\r\n  const hemisphereLight = new HemisphereLight(LIGHT_CREAM, PANTONE_BLUE_2020, 0.8);\r\n  return [directionalLight, directionalLight2, ambientLight, hemisphereLight];\r\n};\r\n\r\nexport const setupRenderer = (windowWidth: number, windowHeight: number) => {\r\n  const renderer = new WebGLRenderer({ antialias: true });\r\n  renderer.setSize(windowWidth, windowHeight);\r\n  return renderer;\r\n};\r\n\r\nexport const createFontMesh = (textGeometry: TextBufferGeometry) =>\r\n  new Mesh(\r\n    textGeometry,\r\n    new MeshPhysicalMaterial({\r\n      color: PANTONE_BLUE_2020,\r\n      metalness: 0.5,\r\n      roughness: 0.5,\r\n      opacity: 0.5,\r\n      envMapIntensity: 5\r\n    })\r\n  );\r\n\r\nexport const createFontLine = (textGeometry: TextBufferGeometry) =>\r\n  new LineSegments(\r\n    new EdgesGeometry(textGeometry),\r\n    new LineBasicMaterial({\r\n      color: WHITE,\r\n      linewidth: 1\r\n    })\r\n  );\r\n\r\nexport const loadText = () => {\r\n  const textloader = new FontLoader();\r\n  const font = textloader.parse(fontJson);\r\n  const geometry = new TextBufferGeometry(\"皓\", {\r\n    font,\r\n    size: 200,\r\n    height: 20,\r\n    curveSegments: 1\r\n  });\r\n  geometry.computeBoundingBox();\r\n  return geometry;\r\n};\r\n\r\nexport const setupCircle = () => {\r\n  const circleGeo = new CircleGeometry(400, 50);\r\n  const circleMat = new MeshBasicMaterial({ color: LIGHT_YELLOW });\r\n  const circle = new Mesh(circleGeo, circleMat);\r\n  circle.position.set(0, 200, -2500);\r\n  return circle;\r\n};\r\n\r\nexport interface ExtendedVector3 extends Vector3 {\r\n  velocity: number;\r\n}\r\n\r\nexport const setupStars = (starCount = 1000) => {\r\n  const starTexture = new TextureLoader().load(star);\r\n  const starGeo = new Geometry();\r\n  for (let i = 0; i < starCount; i++) {\r\n    const star = new Vector3(\r\n      Math.random() * 3000 - 1500,\r\n      Math.random() * 3000 - 1500,\r\n      Math.random() * 3000 - 1500\r\n    );\r\n    const extendedStar = { ...star, velocity: 0 } as unknown;\r\n    starGeo.vertices.push(extendedStar as Vector3);\r\n  }\r\n  const starMaterial = new PointsMaterial({\r\n    color: LIGHT_CREAM,\r\n    size: 5,\r\n    transparent: true,\r\n    map: starTexture\r\n  });\r\n  return new Points(starGeo, starMaterial);\r\n};\r\n","export const colorPalette = {\n  WHITE: 0xffffff,\n  LIGHT_CREAM: 0xfffff7,\n  LIGHT_YELLOW: 0xffccaa,\n  PANTONE_BLUE_2020: 0x0f4c81,\n  NIGHT_OWL_BLUE: 0x000c1d\n};\n\nexport const fftSize = 1024;\n\nexport const fogDensity = 0.0005;\n","// Hooks from https://usehooks.com/useWindowSize/\nimport { useState, useEffect } from \"react\";\n\nexport default () => {\n  const isClient = typeof window === \"object\";\n\n  const getSize = () => {\n    return {\n      width: isClient ? window.innerWidth : 100,\n      height: isClient ? window.innerHeight : 100\n    };\n  };\n\n  const [windowSize, setWindowSize] = useState(getSize);\n\n  useEffect(() => {\n    if (!isClient) {\n      return undefined;\n    }\n\n    const handleResize = () => {\n      setWindowSize(getSize());\n    };\n\n    window.addEventListener(\"resize\", handleResize);\n    return () => window.removeEventListener(\"resize\", handleResize);\n  });\n\n  return windowSize;\n};\n","import { MemoExoticComponent } from \"react\";\n\nimport Three from \"./components/three\";\n\nexport interface Route {\n  path: string;\n  exact: boolean;\n  component: (() => JSX.Element) | MemoExoticComponent<() => JSX.Element>;\n}\n\nconst routes: Route[] = [{ path: \"/\", exact: true, component: Three }];\n\nexport default routes;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport { BrowserRouter, Switch, Route } from \"react-router-dom\";\n\nimport \"./index.css\";\nimport * as serviceWorker from \"./serviceWorker\";\n\nimport routes from \"./routes\";\n\nReactDOM.render(\n  <BrowserRouter basename={process.env.PUBLIC_URL}>\n    <Switch>\n      {routes.map(({ path, exact, component }) => (\n        <Route key={path} path={path} exact={exact} component={component} />\n      ))}\n    </Switch>\n  </BrowserRouter>,\n  document.getElementById(\"root\")\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}